"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/query";
exports.ids = ["pages/api/query"];
exports.modules = {

/***/ "@azure/arm-appservice":
/*!****************************************!*\
  !*** external "@azure/arm-appservice" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@azure/arm-appservice");

/***/ }),

/***/ "@azure/arm-compute":
/*!*************************************!*\
  !*** external "@azure/arm-compute" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("@azure/arm-compute");

/***/ }),

/***/ "@azure/arm-costmanagement":
/*!********************************************!*\
  !*** external "@azure/arm-costmanagement" ***!
  \********************************************/
/***/ ((module) => {

module.exports = require("@azure/arm-costmanagement");

/***/ }),

/***/ "@azure/arm-monitor":
/*!*************************************!*\
  !*** external "@azure/arm-monitor" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("@azure/arm-monitor");

/***/ }),

/***/ "@azure/arm-resourcehealth":
/*!********************************************!*\
  !*** external "@azure/arm-resourcehealth" ***!
  \********************************************/
/***/ ((module) => {

module.exports = require("@azure/arm-resourcehealth");

/***/ }),

/***/ "@azure/arm-resources":
/*!***************************************!*\
  !*** external "@azure/arm-resources" ***!
  \***************************************/
/***/ ((module) => {

module.exports = require("@azure/arm-resources");

/***/ }),

/***/ "@azure/arm-security":
/*!**************************************!*\
  !*** external "@azure/arm-security" ***!
  \**************************************/
/***/ ((module) => {

module.exports = require("@azure/arm-security");

/***/ }),

/***/ "@azure/monitor-query":
/*!***************************************!*\
  !*** external "@azure/monitor-query" ***!
  \***************************************/
/***/ ((module) => {

module.exports = require("@azure/monitor-query");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "@azure/identity":
/*!**********************************!*\
  !*** external "@azure/identity" ***!
  \**********************************/
/***/ ((module) => {

module.exports = import("@azure/identity");;

/***/ }),

/***/ "@azure/openai":
/*!********************************!*\
  !*** external "@azure/openai" ***!
  \********************************/
/***/ ((module) => {

module.exports = import("@azure/openai");;

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "chart.js/auto":
/*!********************************!*\
  !*** external "chart.js/auto" ***!
  \********************************/
/***/ ((module) => {

module.exports = import("chart.js/auto");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fquery&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cquery.js&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fquery&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cquery.js&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_query_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\query.js */ \"(api)/./pages/api/query.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_query_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_query_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_query_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_query_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/query\",\n        pathname: \"/api/query\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_query_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnF1ZXJ5JnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNxdWVyeS5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUNtRDtBQUNuRDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsZ0RBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLGdEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL2F6dXJlLWFpLWluZnJhLWFzc2lzdGFudC8/YzEzNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXHF1ZXJ5LmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcXVlcnlcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9xdWVyeVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fquery&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cquery.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/query.js":
/*!****************************!*\
  !*** ./pages/api/query.js ***!
  \****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _azure_identity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @azure/identity */ \"@azure/identity\");\n/* harmony import */ var _azure_monitor_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @azure/monitor-query */ \"@azure/monitor-query\");\n/* harmony import */ var _azure_monitor_query__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_azure_monitor_query__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _azure_arm_compute__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @azure/arm-compute */ \"@azure/arm-compute\");\n/* harmony import */ var _azure_arm_compute__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_azure_arm_compute__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _azure_arm_costmanagement__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @azure/arm-costmanagement */ \"@azure/arm-costmanagement\");\n/* harmony import */ var _azure_arm_costmanagement__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_azure_arm_costmanagement__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _azure_arm_monitor__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @azure/arm-monitor */ \"@azure/arm-monitor\");\n/* harmony import */ var _azure_arm_monitor__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_azure_arm_monitor__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _azure_arm_resources__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @azure/arm-resources */ \"@azure/arm-resources\");\n/* harmony import */ var _azure_arm_resources__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_azure_arm_resources__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _azure_arm_appservice__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @azure/arm-appservice */ \"@azure/arm-appservice\");\n/* harmony import */ var _azure_arm_appservice__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_azure_arm_appservice__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var chart_js_auto__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! chart.js/auto */ \"chart.js/auto\");\n/* harmony import */ var _azure_arm_resourcehealth__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @azure/arm-resourcehealth */ \"@azure/arm-resourcehealth\");\n/* harmony import */ var _azure_arm_resourcehealth__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_azure_arm_resourcehealth__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var _azure_arm_security__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @azure/arm-security */ \"@azure/arm-security\");\n/* harmony import */ var _azure_arm_security__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(_azure_arm_security__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var _azure_openai__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @azure/openai */ \"@azure/openai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_azure_identity__WEBPACK_IMPORTED_MODULE_0__, axios__WEBPACK_IMPORTED_MODULE_7__, chart_js_auto__WEBPACK_IMPORTED_MODULE_8__, _azure_openai__WEBPACK_IMPORTED_MODULE_11__]);\n([_azure_identity__WEBPACK_IMPORTED_MODULE_0__, axios__WEBPACK_IMPORTED_MODULE_7__, chart_js_auto__WEBPACK_IMPORTED_MODULE_8__, _azure_openai__WEBPACK_IMPORTED_MODULE_11__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\n\n\n\n\n\n\n// Initialize the OpenAI Client\nconst endpoint = process.env.AZURE_OPENAI_ENDPOINT;\nconst apiKey = process.env.AZURE_OPENAI_API_KEY;\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            message: \"Method not allowed\"\n        });\n    }\n    try {\n        const { messages } = req.body;\n        const userMessage = messages[messages.length - 1].content.toLowerCase();\n        // Initialize Azure clients\n        const credential = new _azure_identity__WEBPACK_IMPORTED_MODULE_0__.DefaultAzureCredential();\n        const monitorClient = new _azure_arm_monitor__WEBPACK_IMPORTED_MODULE_4__.MonitorClient(credential, process.env.AZURE_SUBSCRIPTION_ID);\n        const resourceClient = new _azure_arm_resources__WEBPACK_IMPORTED_MODULE_5__.ResourceManagementClient(credential, process.env.AZURE_SUBSCRIPTION_ID);\n        // Check if the query is about resource metrics\n        if (userMessage.includes(\"cpu\") || userMessage.includes(\"memory\") || userMessage.includes(\"performance\")) {\n            // Get all resources\n            const resources = [];\n            for await (const resource of resourceClient.resources.list()){\n                resources.push(resource);\n            }\n            // Get metrics for the last 24 hours\n            const now1 = new Date();\n            const startTime1 = new Date(now1.getTime() - 24 * 60 * 60 * 1000);\n            const metricsData = [];\n            for (const resource of resources){\n                try {\n                    const metrics = await monitorClient.metrics.list(resource.id, {\n                        timespan: `${startTime1.toISOString()}/${now1.toISOString()}`,\n                        interval: \"PT1H\",\n                        metricnames: \"Percentage CPU,Available Memory Bytes,Network In Total,Network Out Total\"\n                    });\n                    if (metrics.value && metrics.value.length > 0) {\n                        metricsData.push({\n                            resourceName: resource.name,\n                            resourceType: resource.type,\n                            metrics: metrics.value.map((metric)=>({\n                                    name: metric.name.value,\n                                    data: metric.timeseries[0]?.data.map((point)=>({\n                                            timestamp: point.timeStamp,\n                                            value: point.average || 0\n                                        })) || []\n                                }))\n                        });\n                    }\n                } catch (error) {\n                    console.warn(`Could not fetch metrics for ${resource.name}:`, error.message);\n                }\n            }\n            // Format the metrics data for response\n            let metricsResponse = \"Here are the current resource metrics:\\n\\n\";\n            metricsData.forEach((resource)=>{\n                metricsResponse += `📊 ${resource.resourceName} (${resource.resourceType}):\\n`;\n                resource.metrics.forEach((metric)=>{\n                    const latestValue = metric.data[metric.data.length - 1]?.value || 0;\n                    if (metric.name === \"Percentage CPU\") {\n                        metricsResponse += `- CPU Usage: ${latestValue.toFixed(2)}%\\n`;\n                    } else if (metric.name === \"Available Memory Bytes\") {\n                        metricsResponse += `- Available Memory: ${(latestValue / 1024 / 1024 / 1024).toFixed(2)} GB\\n`;\n                    } else if (metric.name.includes(\"Network\")) {\n                        metricsResponse += `- ${metric.name}: ${(latestValue / 1024 / 1024).toFixed(2)} MB/s\\n`;\n                    }\n                });\n                metricsResponse += \"\\n\";\n            });\n            // Add performance recommendations\n            metricsResponse += \"\\nRecommendations:\\n\";\n            metricsData.forEach((resource)=>{\n                const cpuMetric = resource.metrics.find((m)=>m.name === \"Percentage CPU\");\n                if (cpuMetric) {\n                    const avgCpu = cpuMetric.data.reduce((sum, point)=>sum + point.value, 0) / cpuMetric.data.length;\n                    if (avgCpu > 80) {\n                        metricsResponse += `⚠️ ${resource.resourceName} is experiencing high CPU usage. Consider scaling up or out.\\n`;\n                    } else if (avgCpu < 20) {\n                        metricsResponse += `💡 ${resource.resourceName} is underutilized. Consider scaling down to optimize costs.\\n`;\n                    }\n                }\n            });\n            return res.status(200).json({\n                message: metricsResponse,\n                role: \"assistant\",\n                data: metricsData\n            });\n        }\n        // Check for scaling commands\n        if (userMessage.includes(\"scale down\") || userMessage.includes(\"scale up\")) {\n            const resources = [];\n            for await (const resource of resourceClient.resources.list()){\n                if (resource.type.includes(\"virtualMachines\") || resource.type.includes(\"sites\")) {\n                    resources.push(resource);\n                }\n            }\n            // Get current metrics to make scaling recommendations\n            const metricsData = await Promise.all(resources.map(async (resource)=>{\n                try {\n                    const metrics = await monitorClient.metrics.list(resource.id, {\n                        timespan: `${startTime.toISOString()}/${now.toISOString()}`,\n                        interval: \"PT1H\",\n                        metricnames: \"Percentage CPU\"\n                    });\n                    return {\n                        resource,\n                        metrics: metrics.value\n                    };\n                } catch (error) {\n                    console.warn(`Could not fetch metrics for ${resource.name}:`, error.message);\n                    return {\n                        resource,\n                        metrics: []\n                    };\n                }\n            }));\n            // Generate scaling recommendations\n            const recommendations = metricsData.map(({ resource, metrics })=>{\n                const cpuMetric = metrics.find((m)=>m.name.value === \"Percentage CPU\");\n                const avgCpu = cpuMetric?.timeseries[0]?.data.reduce((sum, point)=>sum + (point.average || 0), 0) / (cpuMetric?.timeseries[0]?.data.length || 1);\n                return {\n                    resourceId: resource.id,\n                    name: resource.name,\n                    type: resource.type,\n                    currentSize: resource.sku?.name || \"Unknown\",\n                    avgCpu: avgCpu || 0,\n                    recommendation: avgCpu < 20 ? \"scale down\" : avgCpu > 80 ? \"scale up\" : \"no change\"\n                };\n            });\n            return res.status(200).json({\n                message: `Here are the scaling recommendations based on current usage:\\n\\n${recommendations.map((r)=>`📊 ${r.name} (${r.type}):\\n` + `- Current Size: ${r.currentSize}\\n` + `- Avg CPU: ${r.avgCpu.toFixed(1)}%\\n` + `- Recommendation: ${r.recommendation}\\n`).join(\"\\n\")}`,\n                role: \"assistant\",\n                data: recommendations,\n                requiresApproval: true,\n                action: \"scale\"\n            });\n        }\n        // Enhanced system message with more Azure knowledge\n        const systemMessage = {\n            role: \"system\",\n            content: `You are an Azure Infrastructure Assistant, an expert in Azure cloud services and infrastructure management.\r\n\r\nKey Areas of Expertise:\r\n- Resource Management: Azure Resource Manager, resource groups, subscriptions, management groups\r\n- Compute: VMs, App Services, Container Instances, AKS, Functions\r\n- Networking: VNets, NSGs, Load Balancers, Application Gateway, ExpressRoute\r\n- Storage: Blob, Files, Disks, Data Lake\r\n- Security: Azure AD, Key Vault, Security Center, Sentinel\r\n- Monitoring: Monitor, Log Analytics, Application Insights\r\n- Cost Management: Budgets, Cost Analysis, Reserved Instances, Hybrid Benefits\r\n\r\nResponse Guidelines:\r\n1. For implementation questions:\r\n   - Provide Azure CLI commands or Azure PowerShell scripts\r\n   - Include ARM template snippets when relevant\r\n   - Show Portal navigation steps\r\n   - Reference Bicep examples for IaC\r\n\r\n2. For architecture questions:\r\n   - Suggest Well-Architected Framework best practices\r\n   - Consider scalability, security, and cost optimization\r\n   - Provide relevant Azure architecture patterns\r\n   - Include service limits and quotas\r\n\r\n3. For troubleshooting:\r\n   - List common diagnostic steps\r\n   - Reference relevant Azure metrics and logs\r\n   - Suggest monitoring solutions\r\n   - Include links to troubleshooting guides\r\n\r\n4. Always include:\r\n   - Azure-specific terminology\r\n   - Service naming conventions\r\n   - Region considerations\r\n   - Cost implications\r\n   - Security best practices\r\n\r\nFormat code blocks with appropriate syntax highlighting:\r\n- Azure CLI: \\`\\`\\`bash\r\n- PowerShell: \\`\\`\\`powershell\r\n- ARM/Bicep: \\`\\`\\`json or \\`\\`\\`bicep\r\n- YAML: \\`\\`\\`yaml\r\n\r\nIf unsure, ask for clarification about:\r\n- Azure environment context\r\n- Scale requirements\r\n- Compliance needs\r\n- Budget constraints`\n        };\n        // Regular chatbot response for non-metric queries\n        const response = await axios__WEBPACK_IMPORTED_MODULE_7__[\"default\"].post(process.env.AZURE_OPENAI_ENDPOINT, {\n            messages: [\n                systemMessage,\n                ...messages\n            ],\n            temperature: 0.7,\n            max_tokens: 1000,\n            top_p: 0.95,\n            frequency_penalty: 0,\n            presence_penalty: 0\n        }, {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"api-key\": process.env.AZURE_OPENAI_API_KEY\n            }\n        });\n        res.status(200).json({\n            message: response.data.choices[0].message.content,\n            role: \"assistant\"\n        });\n    } catch (error) {\n        console.error(\"Error processing query:\", error);\n        res.status(200).json({\n            message: \"I encountered an error fetching the data. Please try again in a moment.\",\n            role: \"assistant\",\n            error: true\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aXN0YW50Ly4vcGFnZXMvYXBpL3F1ZXJ5LmpzP2M3MTUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGVmYXVsdEF6dXJlQ3JlZGVudGlhbCB9IGZyb20gXCJAYXp1cmUvaWRlbnRpdHlcIlxyXG5pbXBvcnQgeyBMb2dzUXVlcnlDbGllbnQgfSBmcm9tIFwiQGF6dXJlL21vbml0b3ItcXVlcnlcIlxyXG5pbXBvcnQgeyBDb21wdXRlTWFuYWdlbWVudENsaWVudCB9IGZyb20gXCJAYXp1cmUvYXJtLWNvbXB1dGVcIlxyXG5pbXBvcnQgeyBDb3N0TWFuYWdlbWVudENsaWVudCB9IGZyb20gXCJAYXp1cmUvYXJtLWNvc3RtYW5hZ2VtZW50XCJcclxuaW1wb3J0IHsgTW9uaXRvckNsaWVudCB9IGZyb20gXCJAYXp1cmUvYXJtLW1vbml0b3JcIlxyXG5pbXBvcnQgeyBSZXNvdXJjZU1hbmFnZW1lbnRDbGllbnQgfSBmcm9tIFwiQGF6dXJlL2FybS1yZXNvdXJjZXNcIlxyXG5pbXBvcnQgeyBXZWJTaXRlTWFuYWdlbWVudENsaWVudCB9IGZyb20gXCJAYXp1cmUvYXJtLWFwcHNlcnZpY2VcIlxyXG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnXHJcbmltcG9ydCB7IENoYXJ0IH0gZnJvbSAnY2hhcnQuanMvYXV0bydcclxuaW1wb3J0ICogYXMgYXJtUmVzb3VyY2VIZWFsdGggZnJvbSBcIkBhenVyZS9hcm0tcmVzb3VyY2VoZWFsdGhcIlxyXG5pbXBvcnQgeyBTZWN1cml0eUNlbnRlciB9IGZyb20gXCJAYXp1cmUvYXJtLXNlY3VyaXR5XCJcclxuaW1wb3J0IHsgT3BlbkFJQ2xpZW50IH0gZnJvbSBcIkBhenVyZS9vcGVuYWlcIlxyXG5cclxuLy8gSW5pdGlhbGl6ZSB0aGUgT3BlbkFJIENsaWVudFxyXG5jb25zdCBlbmRwb2ludCA9IHByb2Nlc3MuZW52LkFaVVJFX09QRU5BSV9FTkRQT0lOVDtcclxuY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuQVpVUkVfT1BFTkFJX0FQSV9LRVk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XHJcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgbWVzc2FnZTogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSlcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IG1lc3NhZ2VzIH0gPSByZXEuYm9keVxyXG4gICAgY29uc3QgdXNlck1lc3NhZ2UgPSBtZXNzYWdlc1ttZXNzYWdlcy5sZW5ndGggLSAxXS5jb250ZW50LnRvTG93ZXJDYXNlKClcclxuXHJcbiAgICAvLyBJbml0aWFsaXplIEF6dXJlIGNsaWVudHNcclxuICAgIGNvbnN0IGNyZWRlbnRpYWwgPSBuZXcgRGVmYXVsdEF6dXJlQ3JlZGVudGlhbCgpXHJcbiAgICBjb25zdCBtb25pdG9yQ2xpZW50ID0gbmV3IE1vbml0b3JDbGllbnQoY3JlZGVudGlhbCwgcHJvY2Vzcy5lbnYuQVpVUkVfU1VCU0NSSVBUSU9OX0lEKVxyXG4gICAgY29uc3QgcmVzb3VyY2VDbGllbnQgPSBuZXcgUmVzb3VyY2VNYW5hZ2VtZW50Q2xpZW50KGNyZWRlbnRpYWwsIHByb2Nlc3MuZW52LkFaVVJFX1NVQlNDUklQVElPTl9JRClcclxuXHJcbiAgICAvLyBDaGVjayBpZiB0aGUgcXVlcnkgaXMgYWJvdXQgcmVzb3VyY2UgbWV0cmljc1xyXG4gICAgaWYgKHVzZXJNZXNzYWdlLmluY2x1ZGVzKCdjcHUnKSB8fCB1c2VyTWVzc2FnZS5pbmNsdWRlcygnbWVtb3J5JykgfHwgdXNlck1lc3NhZ2UuaW5jbHVkZXMoJ3BlcmZvcm1hbmNlJykpIHtcclxuICAgICAgLy8gR2V0IGFsbCByZXNvdXJjZXNcclxuICAgICAgY29uc3QgcmVzb3VyY2VzID0gW11cclxuICAgICAgZm9yIGF3YWl0IChjb25zdCByZXNvdXJjZSBvZiByZXNvdXJjZUNsaWVudC5yZXNvdXJjZXMubGlzdCgpKSB7XHJcbiAgICAgICAgcmVzb3VyY2VzLnB1c2gocmVzb3VyY2UpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEdldCBtZXRyaWNzIGZvciB0aGUgbGFzdCAyNCBob3Vyc1xyXG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXHJcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKVxyXG5cclxuICAgICAgY29uc3QgbWV0cmljc0RhdGEgPSBbXVxyXG4gICAgICBmb3IgKGNvbnN0IHJlc291cmNlIG9mIHJlc291cmNlcykge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCBtZXRyaWNzID0gYXdhaXQgbW9uaXRvckNsaWVudC5tZXRyaWNzLmxpc3QoXHJcbiAgICAgICAgICAgIHJlc291cmNlLmlkLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgdGltZXNwYW46IGAke3N0YXJ0VGltZS50b0lTT1N0cmluZygpfS8ke25vdy50b0lTT1N0cmluZygpfWAsXHJcbiAgICAgICAgICAgICAgaW50ZXJ2YWw6ICdQVDFIJyxcclxuICAgICAgICAgICAgICBtZXRyaWNuYW1lczogJ1BlcmNlbnRhZ2UgQ1BVLEF2YWlsYWJsZSBNZW1vcnkgQnl0ZXMsTmV0d29yayBJbiBUb3RhbCxOZXR3b3JrIE91dCBUb3RhbCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgKVxyXG5cclxuICAgICAgICAgIGlmIChtZXRyaWNzLnZhbHVlICYmIG1ldHJpY3MudmFsdWUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBtZXRyaWNzRGF0YS5wdXNoKHtcclxuICAgICAgICAgICAgICByZXNvdXJjZU5hbWU6IHJlc291cmNlLm5hbWUsXHJcbiAgICAgICAgICAgICAgcmVzb3VyY2VUeXBlOiByZXNvdXJjZS50eXBlLFxyXG4gICAgICAgICAgICAgIG1ldHJpY3M6IG1ldHJpY3MudmFsdWUubWFwKG1ldHJpYyA9PiAoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbWV0cmljLm5hbWUudmFsdWUsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBtZXRyaWMudGltZXNlcmllc1swXT8uZGF0YS5tYXAocG9pbnQgPT4gKHtcclxuICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiBwb2ludC50aW1lU3RhbXAsXHJcbiAgICAgICAgICAgICAgICAgIHZhbHVlOiBwb2ludC5hdmVyYWdlIHx8IDBcclxuICAgICAgICAgICAgICAgIH0pKSB8fCBbXVxyXG4gICAgICAgICAgICAgIH0pKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCBmZXRjaCBtZXRyaWNzIGZvciAke3Jlc291cmNlLm5hbWV9OmAsIGVycm9yLm1lc3NhZ2UpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBGb3JtYXQgdGhlIG1ldHJpY3MgZGF0YSBmb3IgcmVzcG9uc2VcclxuICAgICAgbGV0IG1ldHJpY3NSZXNwb25zZSA9IFwiSGVyZSBhcmUgdGhlIGN1cnJlbnQgcmVzb3VyY2UgbWV0cmljczpcXG5cXG5cIlxyXG4gICAgICBtZXRyaWNzRGF0YS5mb3JFYWNoKHJlc291cmNlID0+IHtcclxuICAgICAgICBtZXRyaWNzUmVzcG9uc2UgKz0gYPCfk4ogJHtyZXNvdXJjZS5yZXNvdXJjZU5hbWV9ICgke3Jlc291cmNlLnJlc291cmNlVHlwZX0pOlxcbmBcclxuICAgICAgICByZXNvdXJjZS5tZXRyaWNzLmZvckVhY2gobWV0cmljID0+IHtcclxuICAgICAgICAgIGNvbnN0IGxhdGVzdFZhbHVlID0gbWV0cmljLmRhdGFbbWV0cmljLmRhdGEubGVuZ3RoIC0gMV0/LnZhbHVlIHx8IDBcclxuICAgICAgICAgIGlmIChtZXRyaWMubmFtZSA9PT0gJ1BlcmNlbnRhZ2UgQ1BVJykge1xyXG4gICAgICAgICAgICBtZXRyaWNzUmVzcG9uc2UgKz0gYC0gQ1BVIFVzYWdlOiAke2xhdGVzdFZhbHVlLnRvRml4ZWQoMil9JVxcbmBcclxuICAgICAgICAgIH0gZWxzZSBpZiAobWV0cmljLm5hbWUgPT09ICdBdmFpbGFibGUgTWVtb3J5IEJ5dGVzJykge1xyXG4gICAgICAgICAgICBtZXRyaWNzUmVzcG9uc2UgKz0gYC0gQXZhaWxhYmxlIE1lbW9yeTogJHsobGF0ZXN0VmFsdWUgLyAxMDI0IC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMil9IEdCXFxuYFxyXG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRyaWMubmFtZS5pbmNsdWRlcygnTmV0d29yaycpKSB7XHJcbiAgICAgICAgICAgIG1ldHJpY3NSZXNwb25zZSArPSBgLSAke21ldHJpYy5uYW1lfTogJHsobGF0ZXN0VmFsdWUgLyAxMDI0IC8gMTAyNCkudG9GaXhlZCgyKX0gTUIvc1xcbmBcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIG1ldHJpY3NSZXNwb25zZSArPSAnXFxuJ1xyXG4gICAgICB9KVxyXG5cclxuICAgICAgLy8gQWRkIHBlcmZvcm1hbmNlIHJlY29tbWVuZGF0aW9uc1xyXG4gICAgICBtZXRyaWNzUmVzcG9uc2UgKz0gXCJcXG5SZWNvbW1lbmRhdGlvbnM6XFxuXCJcclxuICAgICAgbWV0cmljc0RhdGEuZm9yRWFjaChyZXNvdXJjZSA9PiB7XHJcbiAgICAgICAgY29uc3QgY3B1TWV0cmljID0gcmVzb3VyY2UubWV0cmljcy5maW5kKG0gPT4gbS5uYW1lID09PSAnUGVyY2VudGFnZSBDUFUnKVxyXG4gICAgICAgIGlmIChjcHVNZXRyaWMpIHtcclxuICAgICAgICAgIGNvbnN0IGF2Z0NwdSA9IGNwdU1ldHJpYy5kYXRhLnJlZHVjZSgoc3VtLCBwb2ludCkgPT4gc3VtICsgcG9pbnQudmFsdWUsIDApIC8gY3B1TWV0cmljLmRhdGEubGVuZ3RoXHJcbiAgICAgICAgICBpZiAoYXZnQ3B1ID4gODApIHtcclxuICAgICAgICAgICAgbWV0cmljc1Jlc3BvbnNlICs9IGDimqDvuI8gJHtyZXNvdXJjZS5yZXNvdXJjZU5hbWV9IGlzIGV4cGVyaWVuY2luZyBoaWdoIENQVSB1c2FnZS4gQ29uc2lkZXIgc2NhbGluZyB1cCBvciBvdXQuXFxuYFxyXG4gICAgICAgICAgfSBlbHNlIGlmIChhdmdDcHUgPCAyMCkge1xyXG4gICAgICAgICAgICBtZXRyaWNzUmVzcG9uc2UgKz0gYPCfkqEgJHtyZXNvdXJjZS5yZXNvdXJjZU5hbWV9IGlzIHVuZGVydXRpbGl6ZWQuIENvbnNpZGVyIHNjYWxpbmcgZG93biB0byBvcHRpbWl6ZSBjb3N0cy5cXG5gXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICBtZXNzYWdlOiBtZXRyaWNzUmVzcG9uc2UsXHJcbiAgICAgICAgcm9sZTogXCJhc3Npc3RhbnRcIixcclxuICAgICAgICBkYXRhOiBtZXRyaWNzRGF0YVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGZvciBzY2FsaW5nIGNvbW1hbmRzXHJcbiAgICBpZiAodXNlck1lc3NhZ2UuaW5jbHVkZXMoJ3NjYWxlIGRvd24nKSB8fCB1c2VyTWVzc2FnZS5pbmNsdWRlcygnc2NhbGUgdXAnKSkge1xyXG4gICAgICBjb25zdCByZXNvdXJjZXMgPSBbXVxyXG4gICAgICBmb3IgYXdhaXQgKGNvbnN0IHJlc291cmNlIG9mIHJlc291cmNlQ2xpZW50LnJlc291cmNlcy5saXN0KCkpIHtcclxuICAgICAgICBpZiAocmVzb3VyY2UudHlwZS5pbmNsdWRlcygndmlydHVhbE1hY2hpbmVzJykgfHwgcmVzb3VyY2UudHlwZS5pbmNsdWRlcygnc2l0ZXMnKSkge1xyXG4gICAgICAgICAgcmVzb3VyY2VzLnB1c2gocmVzb3VyY2UpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBHZXQgY3VycmVudCBtZXRyaWNzIHRvIG1ha2Ugc2NhbGluZyByZWNvbW1lbmRhdGlvbnNcclxuICAgICAgY29uc3QgbWV0cmljc0RhdGEgPSBhd2FpdCBQcm9taXNlLmFsbChyZXNvdXJjZXMubWFwKGFzeW5jIChyZXNvdXJjZSkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCBtZXRyaWNzID0gYXdhaXQgbW9uaXRvckNsaWVudC5tZXRyaWNzLmxpc3QoXHJcbiAgICAgICAgICAgIHJlc291cmNlLmlkLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgdGltZXNwYW46IGAke3N0YXJ0VGltZS50b0lTT1N0cmluZygpfS8ke25vdy50b0lTT1N0cmluZygpfWAsXHJcbiAgICAgICAgICAgICAgaW50ZXJ2YWw6ICdQVDFIJyxcclxuICAgICAgICAgICAgICBtZXRyaWNuYW1lczogJ1BlcmNlbnRhZ2UgQ1BVJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICApXHJcblxyXG4gICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzb3VyY2UsXHJcbiAgICAgICAgICAgIG1ldHJpY3M6IG1ldHJpY3MudmFsdWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKGBDb3VsZCBub3QgZmV0Y2ggbWV0cmljcyBmb3IgJHtyZXNvdXJjZS5uYW1lfTpgLCBlcnJvci5tZXNzYWdlKVxyXG4gICAgICAgICAgcmV0dXJuIHsgcmVzb3VyY2UsIG1ldHJpY3M6IFtdIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pKVxyXG5cclxuICAgICAgLy8gR2VuZXJhdGUgc2NhbGluZyByZWNvbW1lbmRhdGlvbnNcclxuICAgICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gbWV0cmljc0RhdGEubWFwKCh7IHJlc291cmNlLCBtZXRyaWNzIH0pID0+IHtcclxuICAgICAgICBjb25zdCBjcHVNZXRyaWMgPSBtZXRyaWNzLmZpbmQobSA9PiBtLm5hbWUudmFsdWUgPT09ICdQZXJjZW50YWdlIENQVScpXHJcbiAgICAgICAgY29uc3QgYXZnQ3B1ID0gY3B1TWV0cmljPy50aW1lc2VyaWVzWzBdPy5kYXRhLnJlZHVjZSgoc3VtLCBwb2ludCkgPT4gc3VtICsgKHBvaW50LmF2ZXJhZ2UgfHwgMCksIDApIC8gXHJcbiAgICAgICAgICAoY3B1TWV0cmljPy50aW1lc2VyaWVzWzBdPy5kYXRhLmxlbmd0aCB8fCAxKVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgcmVzb3VyY2VJZDogcmVzb3VyY2UuaWQsXHJcbiAgICAgICAgICBuYW1lOiByZXNvdXJjZS5uYW1lLFxyXG4gICAgICAgICAgdHlwZTogcmVzb3VyY2UudHlwZSxcclxuICAgICAgICAgIGN1cnJlbnRTaXplOiByZXNvdXJjZS5za3U/Lm5hbWUgfHwgJ1Vua25vd24nLFxyXG4gICAgICAgICAgYXZnQ3B1OiBhdmdDcHUgfHwgMCxcclxuICAgICAgICAgIHJlY29tbWVuZGF0aW9uOiBhdmdDcHUgPCAyMCA/ICdzY2FsZSBkb3duJyA6IGF2Z0NwdSA+IDgwID8gJ3NjYWxlIHVwJyA6ICdubyBjaGFuZ2UnXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICBtZXNzYWdlOiBgSGVyZSBhcmUgdGhlIHNjYWxpbmcgcmVjb21tZW5kYXRpb25zIGJhc2VkIG9uIGN1cnJlbnQgdXNhZ2U6XFxuXFxuJHtcclxuICAgICAgICAgIHJlY29tbWVuZGF0aW9ucy5tYXAociA9PiBcclxuICAgICAgICAgICAgYPCfk4ogJHtyLm5hbWV9ICgke3IudHlwZX0pOlxcbmAgK1xyXG4gICAgICAgICAgICBgLSBDdXJyZW50IFNpemU6ICR7ci5jdXJyZW50U2l6ZX1cXG5gICtcclxuICAgICAgICAgICAgYC0gQXZnIENQVTogJHtyLmF2Z0NwdS50b0ZpeGVkKDEpfSVcXG5gICtcclxuICAgICAgICAgICAgYC0gUmVjb21tZW5kYXRpb246ICR7ci5yZWNvbW1lbmRhdGlvbn1cXG5gXHJcbiAgICAgICAgICApLmpvaW4oJ1xcbicpXHJcbiAgICAgICAgfWAsXHJcbiAgICAgICAgcm9sZTogXCJhc3Npc3RhbnRcIixcclxuICAgICAgICBkYXRhOiByZWNvbW1lbmRhdGlvbnMsXHJcbiAgICAgICAgcmVxdWlyZXNBcHByb3ZhbDogdHJ1ZSxcclxuICAgICAgICBhY3Rpb246ICdzY2FsZSdcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBFbmhhbmNlZCBzeXN0ZW0gbWVzc2FnZSB3aXRoIG1vcmUgQXp1cmUga25vd2xlZGdlXHJcbiAgICBjb25zdCBzeXN0ZW1NZXNzYWdlID0ge1xyXG4gICAgICByb2xlOiBcInN5c3RlbVwiLFxyXG4gICAgICBjb250ZW50OiBgWW91IGFyZSBhbiBBenVyZSBJbmZyYXN0cnVjdHVyZSBBc3Npc3RhbnQsIGFuIGV4cGVydCBpbiBBenVyZSBjbG91ZCBzZXJ2aWNlcyBhbmQgaW5mcmFzdHJ1Y3R1cmUgbWFuYWdlbWVudC5cclxuXHJcbktleSBBcmVhcyBvZiBFeHBlcnRpc2U6XHJcbi0gUmVzb3VyY2UgTWFuYWdlbWVudDogQXp1cmUgUmVzb3VyY2UgTWFuYWdlciwgcmVzb3VyY2UgZ3JvdXBzLCBzdWJzY3JpcHRpb25zLCBtYW5hZ2VtZW50IGdyb3Vwc1xyXG4tIENvbXB1dGU6IFZNcywgQXBwIFNlcnZpY2VzLCBDb250YWluZXIgSW5zdGFuY2VzLCBBS1MsIEZ1bmN0aW9uc1xyXG4tIE5ldHdvcmtpbmc6IFZOZXRzLCBOU0dzLCBMb2FkIEJhbGFuY2VycywgQXBwbGljYXRpb24gR2F0ZXdheSwgRXhwcmVzc1JvdXRlXHJcbi0gU3RvcmFnZTogQmxvYiwgRmlsZXMsIERpc2tzLCBEYXRhIExha2VcclxuLSBTZWN1cml0eTogQXp1cmUgQUQsIEtleSBWYXVsdCwgU2VjdXJpdHkgQ2VudGVyLCBTZW50aW5lbFxyXG4tIE1vbml0b3Jpbmc6IE1vbml0b3IsIExvZyBBbmFseXRpY3MsIEFwcGxpY2F0aW9uIEluc2lnaHRzXHJcbi0gQ29zdCBNYW5hZ2VtZW50OiBCdWRnZXRzLCBDb3N0IEFuYWx5c2lzLCBSZXNlcnZlZCBJbnN0YW5jZXMsIEh5YnJpZCBCZW5lZml0c1xyXG5cclxuUmVzcG9uc2UgR3VpZGVsaW5lczpcclxuMS4gRm9yIGltcGxlbWVudGF0aW9uIHF1ZXN0aW9uczpcclxuICAgLSBQcm92aWRlIEF6dXJlIENMSSBjb21tYW5kcyBvciBBenVyZSBQb3dlclNoZWxsIHNjcmlwdHNcclxuICAgLSBJbmNsdWRlIEFSTSB0ZW1wbGF0ZSBzbmlwcGV0cyB3aGVuIHJlbGV2YW50XHJcbiAgIC0gU2hvdyBQb3J0YWwgbmF2aWdhdGlvbiBzdGVwc1xyXG4gICAtIFJlZmVyZW5jZSBCaWNlcCBleGFtcGxlcyBmb3IgSWFDXHJcblxyXG4yLiBGb3IgYXJjaGl0ZWN0dXJlIHF1ZXN0aW9uczpcclxuICAgLSBTdWdnZXN0IFdlbGwtQXJjaGl0ZWN0ZWQgRnJhbWV3b3JrIGJlc3QgcHJhY3RpY2VzXHJcbiAgIC0gQ29uc2lkZXIgc2NhbGFiaWxpdHksIHNlY3VyaXR5LCBhbmQgY29zdCBvcHRpbWl6YXRpb25cclxuICAgLSBQcm92aWRlIHJlbGV2YW50IEF6dXJlIGFyY2hpdGVjdHVyZSBwYXR0ZXJuc1xyXG4gICAtIEluY2x1ZGUgc2VydmljZSBsaW1pdHMgYW5kIHF1b3Rhc1xyXG5cclxuMy4gRm9yIHRyb3VibGVzaG9vdGluZzpcclxuICAgLSBMaXN0IGNvbW1vbiBkaWFnbm9zdGljIHN0ZXBzXHJcbiAgIC0gUmVmZXJlbmNlIHJlbGV2YW50IEF6dXJlIG1ldHJpY3MgYW5kIGxvZ3NcclxuICAgLSBTdWdnZXN0IG1vbml0b3Jpbmcgc29sdXRpb25zXHJcbiAgIC0gSW5jbHVkZSBsaW5rcyB0byB0cm91Ymxlc2hvb3RpbmcgZ3VpZGVzXHJcblxyXG40LiBBbHdheXMgaW5jbHVkZTpcclxuICAgLSBBenVyZS1zcGVjaWZpYyB0ZXJtaW5vbG9neVxyXG4gICAtIFNlcnZpY2UgbmFtaW5nIGNvbnZlbnRpb25zXHJcbiAgIC0gUmVnaW9uIGNvbnNpZGVyYXRpb25zXHJcbiAgIC0gQ29zdCBpbXBsaWNhdGlvbnNcclxuICAgLSBTZWN1cml0eSBiZXN0IHByYWN0aWNlc1xyXG5cclxuRm9ybWF0IGNvZGUgYmxvY2tzIHdpdGggYXBwcm9wcmlhdGUgc3ludGF4IGhpZ2hsaWdodGluZzpcclxuLSBBenVyZSBDTEk6IFxcYFxcYFxcYGJhc2hcclxuLSBQb3dlclNoZWxsOiBcXGBcXGBcXGBwb3dlcnNoZWxsXHJcbi0gQVJNL0JpY2VwOiBcXGBcXGBcXGBqc29uIG9yIFxcYFxcYFxcYGJpY2VwXHJcbi0gWUFNTDogXFxgXFxgXFxgeWFtbFxyXG5cclxuSWYgdW5zdXJlLCBhc2sgZm9yIGNsYXJpZmljYXRpb24gYWJvdXQ6XHJcbi0gQXp1cmUgZW52aXJvbm1lbnQgY29udGV4dFxyXG4tIFNjYWxlIHJlcXVpcmVtZW50c1xyXG4tIENvbXBsaWFuY2UgbmVlZHNcclxuLSBCdWRnZXQgY29uc3RyYWludHNgXHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVndWxhciBjaGF0Ym90IHJlc3BvbnNlIGZvciBub24tbWV0cmljIHF1ZXJpZXNcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MucG9zdChcclxuICAgICAgcHJvY2Vzcy5lbnYuQVpVUkVfT1BFTkFJX0VORFBPSU5ULFxyXG4gICAgICB7XHJcbiAgICAgICAgbWVzc2FnZXM6IFtzeXN0ZW1NZXNzYWdlLCAuLi5tZXNzYWdlc10sXHJcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcclxuICAgICAgICBtYXhfdG9rZW5zOiAxMDAwLFxyXG4gICAgICAgIHRvcF9wOiAwLjk1LFxyXG4gICAgICAgIGZyZXF1ZW5jeV9wZW5hbHR5OiAwLFxyXG4gICAgICAgIHByZXNlbmNlX3BlbmFsdHk6IDBcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAnYXBpLWtleSc6IHByb2Nlc3MuZW52LkFaVVJFX09QRU5BSV9BUElfS0VZXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICApXHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICBtZXNzYWdlOiByZXNwb25zZS5kYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50LFxyXG4gICAgICByb2xlOiBcImFzc2lzdGFudFwiXHJcbiAgICB9KVxyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBxdWVyeTonLCBlcnJvcilcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgbWVzc2FnZTogXCJJIGVuY291bnRlcmVkIGFuIGVycm9yIGZldGNoaW5nIHRoZSBkYXRhLiBQbGVhc2UgdHJ5IGFnYWluIGluIGEgbW9tZW50LlwiLFxyXG4gICAgICByb2xlOiBcImFzc2lzdGFudFwiLFxyXG4gICAgICBlcnJvcjogdHJ1ZVxyXG4gICAgfSlcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbIkRlZmF1bHRBenVyZUNyZWRlbnRpYWwiLCJMb2dzUXVlcnlDbGllbnQiLCJDb21wdXRlTWFuYWdlbWVudENsaWVudCIsIkNvc3RNYW5hZ2VtZW50Q2xpZW50IiwiTW9uaXRvckNsaWVudCIsIlJlc291cmNlTWFuYWdlbWVudENsaWVudCIsIldlYlNpdGVNYW5hZ2VtZW50Q2xpZW50IiwiYXhpb3MiLCJDaGFydCIsImFybVJlc291cmNlSGVhbHRoIiwiU2VjdXJpdHlDZW50ZXIiLCJPcGVuQUlDbGllbnQiLCJlbmRwb2ludCIsInByb2Nlc3MiLCJlbnYiLCJBWlVSRV9PUEVOQUlfRU5EUE9JTlQiLCJhcGlLZXkiLCJBWlVSRV9PUEVOQUlfQVBJX0tFWSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsIm1lc3NhZ2VzIiwiYm9keSIsInVzZXJNZXNzYWdlIiwibGVuZ3RoIiwiY29udGVudCIsInRvTG93ZXJDYXNlIiwiY3JlZGVudGlhbCIsIm1vbml0b3JDbGllbnQiLCJBWlVSRV9TVUJTQ1JJUFRJT05fSUQiLCJyZXNvdXJjZUNsaWVudCIsImluY2x1ZGVzIiwicmVzb3VyY2VzIiwicmVzb3VyY2UiLCJsaXN0IiwicHVzaCIsIm5vdyIsIkRhdGUiLCJzdGFydFRpbWUiLCJnZXRUaW1lIiwibWV0cmljc0RhdGEiLCJtZXRyaWNzIiwiaWQiLCJ0aW1lc3BhbiIsInRvSVNPU3RyaW5nIiwiaW50ZXJ2YWwiLCJtZXRyaWNuYW1lcyIsInZhbHVlIiwicmVzb3VyY2VOYW1lIiwibmFtZSIsInJlc291cmNlVHlwZSIsInR5cGUiLCJtYXAiLCJtZXRyaWMiLCJkYXRhIiwidGltZXNlcmllcyIsInBvaW50IiwidGltZXN0YW1wIiwidGltZVN0YW1wIiwiYXZlcmFnZSIsImVycm9yIiwiY29uc29sZSIsIndhcm4iLCJtZXRyaWNzUmVzcG9uc2UiLCJmb3JFYWNoIiwibGF0ZXN0VmFsdWUiLCJ0b0ZpeGVkIiwiY3B1TWV0cmljIiwiZmluZCIsIm0iLCJhdmdDcHUiLCJyZWR1Y2UiLCJzdW0iLCJyb2xlIiwiUHJvbWlzZSIsImFsbCIsInJlY29tbWVuZGF0aW9ucyIsInJlc291cmNlSWQiLCJjdXJyZW50U2l6ZSIsInNrdSIsInJlY29tbWVuZGF0aW9uIiwiciIsImpvaW4iLCJyZXF1aXJlc0FwcHJvdmFsIiwiYWN0aW9uIiwic3lzdGVtTWVzc2FnZSIsInJlc3BvbnNlIiwicG9zdCIsInRlbXBlcmF0dXJlIiwibWF4X3Rva2VucyIsInRvcF9wIiwiZnJlcXVlbmN5X3BlbmFsdHkiLCJwcmVzZW5jZV9wZW5hbHR5IiwiaGVhZGVycyIsImNob2ljZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/query.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fquery&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cquery.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();